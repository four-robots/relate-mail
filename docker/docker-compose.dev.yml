version: '3.8'

# Development compose file - use with: docker compose -f docker-compose.yml -f docker-compose.dev.yml up

services:
  api:
    build:
      context: ../api
      dockerfile: Dockerfile
      target: api
    ports:
      - "5000:8080"
    environment:
      - ASPNETCORE_ENVIRONMENT=Development
      - ConnectionStrings__DefaultConnection=Data Source=/data/relate-smtp.db
      - Cors__AllowedOrigins__0=http://localhost:5173
      - Cors__AllowedOrigins__1=http://localhost:3000

  smtp:
    environment:
      - Logging__LogLevel__Default=Debug

  web:
    # In dev, run the frontend with npm run dev instead
    profiles:
      - production
